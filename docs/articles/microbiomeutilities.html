<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>microbiomeutilities example â€¢ microbiomeutilities</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="microbiomeutilities example">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">microbiomeutilities</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/microbiomeutilities.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>microbiomeutilities example</h1>
            
      
      
      <div class="hidden name"><code>microbiomeutilities.Rmd</code></div>

    </div>

    
    
<p><strong>This package is in experimental stage and should be used only for testing/trial purposes. I will keep improving this with time and feedback.</strong></p>
<p>This is mainly a wrapper tool R package. Apart for some simple scripts for data visualization, this package has a single function called <code>microbiome_pipeline</code> for carrying out preliminary QC, Alpha Diversity, Ordination and Composition analysis of OTU tables. The output is a HTML report for convenient investigating of the data.</p>
<div id="install" class="section level2">
<h2 class="hasAnchor">
<a href="#install" class="anchor"></a>Install</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">install.packages</span>(<span class="st">"devtools"</span>)
devtools::<span class="kw">install_github</span>(<span class="st">"microsud/microbiomeutilities"</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">library</span>(microbiomeutilities)
<span class="kw">library</span>(microbiome)
<span class="kw">library</span>(knitr)
<span class="kw">library</span>(tibble)</code></pre></div>
</div>
<div id="example-data" class="section level2">
<h2 class="hasAnchor">
<a href="#example-data" class="anchor"></a>Example data</h2>
<p>A subset of human intestinal biopsy and faecal data from pre-print <a href="https://www.biorxiv.org/content/early/2017/12/06/227272">Shetty SA et al. 2017</a>.</p>
<p>Useful resources:</p>
<p>For more information on phyloseq data structure and uses you can have a look at <a href="http://joey711.github.io/phyloseq/">Phyloseq</a></p>
<p>Tools for microbiome analysis in R. <strong>Microbiome package</strong> URL: <a href="http://microbiome.github.com/microbiome">microbiome package</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">data</span>(<span class="st">"biogeogut"</span>)
ps0 &lt;-<span class="st"> </span>biogeogut

<span class="kw">print</span>(ps0)
<span class="co">#&gt; phyloseq-class experiment-level object</span>
<span class="co">#&gt; otu_table()   OTU Table:         [ 19063 taxa and 14 samples ]</span>
<span class="co">#&gt; sample_data() Sample Data:       [ 14 samples by 6 sample variables ]</span>
<span class="co">#&gt; tax_table()   Taxonomy Table:    [ 19063 taxa by 7 taxonomic ranks ]</span></code></pre></div>
</div>
<div id="microbiome-analysis-pipeline" class="section level2">
<h2 class="hasAnchor">
<a href="#microbiome-analysis-pipeline" class="anchor"></a>Microbiome analysis pipeline</h2>
<p>Function <code>microbiome_pipeline</code> generates an <code>HTML</code> report with preliminary QC, Alpha Diversity, Ordination and Composition analysis of OTU tables. This function saves all intermediate files incuding figures and phyloseq objects in user specified directory.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw"><a href="../reference/microbiome_pipeline.html">microbiome_pipeline</a></span>(
  <span class="dt">otufile =</span> <span class="st">"my.biom"</span>,
  <span class="dt">mapping =</span> <span class="st">"mymap.csv"</span>,
  <span class="dt">taxonomy =</span> <span class="ot">NULL</span>,
  <span class="dt">treefilename =</span> <span class="st">"myTree.tre"</span>,
  <span class="dt">type =</span> <span class="st">"biom"</span>,
  <span class="dt">work_dir =</span> <span class="st">"F:/path/my/input/filefolder"</span>,
  <span class="dt">out_dir =</span> <span class="st">"F:/path/to/save/my/files/folder"</span>,
  <span class="dt">VariableA =</span> <span class="st">"MC_type1"</span>,
  <span class="dt">VariableB =</span> <span class="st">"Region"</span>,
  <span class="dt">UnConstOrd =</span> <span class="ot">TRUE</span>,
  <span class="dt">heatmap =</span> <span class="ot">TRUE</span>,
  <span class="dt">filterCount =</span> <span class="dv">4</span>,
  <span class="dt">filterPrev =</span> <span class="fl">0.01</span>,
  <span class="dt">col.palette =</span> <span class="st">"Paired"</span>,
  <span class="dt">filterpseq =</span> <span class="ot">TRUE</span>,
  <span class="dt">samsize =</span> <span class="ot">NA</span>,
  <span class="dt">projectname =</span> <span class="st">"Mock"</span>,
  <span class="dt">author =</span> <span class="st">"Sudarshan"</span>
  )</code></pre></div>
</div>
<div id="formatting-the-phyloseq-object" class="section level2">
<h2 class="hasAnchor">
<a href="#formatting-the-phyloseq-object" class="anchor"></a>Formatting the Phyloseq Object</h2>
<p>Most commonly it is observed that the taxonomy file has classification until a given taxonomic level. We will fill the empty cells with the maximum classification available along with the OTU number.</p>
<p>Check the taxonomy in phyloseq object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">kable</span>(<span class="kw">head</span>(<span class="kw">tax_table</span>(ps0)))</code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="left">Domain</th>
<th align="left">Phylum</th>
<th align="left">Class</th>
<th align="left">Order</th>
<th align="left">Family</th>
<th align="left">Genus</th>
<th align="left">Species</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>541135</td>
<td align="left">k__Bacteria</td>
<td align="left">p__Firmicutes</td>
<td align="left">c__Bacilli</td>
<td align="left">o__Lactobacillales</td>
<td align="left">f__Lactobacillaceae</td>
<td align="left">g__Lactobacillus</td>
<td align="left">s__</td>
</tr>
<tr class="even">
<td>1050608</td>
<td align="left">k__Bacteria</td>
<td align="left">p__Actinobacteria</td>
<td align="left">c__Actinobacteria</td>
<td align="left">o__Actinomycetales</td>
<td align="left">f__Corynebacteriaceae</td>
<td align="left">g__Corynebacterium</td>
<td align="left">s__</td>
</tr>
<tr class="odd">
<td>370251</td>
<td align="left">k__Bacteria</td>
<td align="left">p__Proteobacteria</td>
<td align="left">c__Gammaproteobacteria</td>
<td align="left">o__Oceanospirillales</td>
<td align="left">f__Endozoicimonaceae</td>
<td align="left">g__</td>
<td align="left">s__</td>
</tr>
<tr class="even">
<td>188753</td>
<td align="left">k__Bacteria</td>
<td align="left">p__Firmicutes</td>
<td align="left">c__Clostridia</td>
<td align="left">o__Clostridiales</td>
<td align="left">f__Lachnospiraceae</td>
<td align="left">g__Blautia</td>
<td align="left">s__</td>
</tr>
<tr class="odd">
<td>217472</td>
<td align="left">k__Bacteria</td>
<td align="left">p__Acidobacteria</td>
<td align="left">c__Acidobacteriia</td>
<td align="left">o__Acidobacteriales</td>
<td align="left">f__Koribacteraceae</td>
<td align="left">g__Candidatus Koribacter</td>
<td align="left">s__</td>
</tr>
<tr class="even">
<td>623634</td>
<td align="left">k__Bacteria</td>
<td align="left">p__Acidobacteria</td>
<td align="left">c__Solibacteres</td>
<td align="left">o__Solibacterales</td>
<td align="left">f__Solibacteraceae</td>
<td align="left">g__Candidatus Solibacter</td>
<td align="left">s__</td>
</tr>
</tbody>
</table>
<p>Some have only g__ of s__ information.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
ps0.f &lt;-<span class="st"> </span><span class="kw"><a href="../reference/format_phyloseq.html">format_phyloseq</a></span>(ps0)
<span class="co">#&gt; This function will change Kingdom to Domain by default in taxonomy</span>
<span class="co">#&gt; Warning: package 'bindrcpp' was built under R version 3.4.4</span>

<span class="kw">kable</span>(<span class="kw">head</span>(<span class="kw">tax_table</span>(ps0.f)))</code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="left">Domain</th>
<th align="left">Phylum</th>
<th align="left">Class</th>
<th align="left">Order</th>
<th align="left">Family</th>
<th align="left">Genus</th>
<th align="left">Species</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>541135</td>
<td align="left">Bacteria</td>
<td align="left">Firmicutes</td>
<td align="left">Bacilli</td>
<td align="left">Lactobacillales</td>
<td align="left">Lactobacillaceae</td>
<td align="left">Lactobacillus</td>
<td align="left">f__Lactobacillus_541135</td>
</tr>
<tr class="even">
<td>1050608</td>
<td align="left">Bacteria</td>
<td align="left">Actinobacteria</td>
<td align="left">Actinobacteria</td>
<td align="left">Actinomycetales</td>
<td align="left">Corynebacteriaceae</td>
<td align="left">Corynebacterium</td>
<td align="left">f__Corynebacterium_1050608</td>
</tr>
<tr class="odd">
<td>370251</td>
<td align="left">Bacteria</td>
<td align="left">Proteobacteria</td>
<td align="left">Gammaproteobacteria</td>
<td align="left">Oceanospirillales</td>
<td align="left">Endozoicimonaceae</td>
<td align="left">f__Endozoicimonaceae_370251</td>
<td align="left">f__Endozoicimonaceae_370251</td>
</tr>
<tr class="even">
<td>188753</td>
<td align="left">Bacteria</td>
<td align="left">Firmicutes</td>
<td align="left">Clostridia</td>
<td align="left">Clostridiales</td>
<td align="left">Lachnospiraceae</td>
<td align="left">Blautia</td>
<td align="left">f__Blautia_188753</td>
</tr>
<tr class="odd">
<td>217472</td>
<td align="left">Bacteria</td>
<td align="left">Acidobacteria</td>
<td align="left">Acidobacteriia</td>
<td align="left">Acidobacteriales</td>
<td align="left">Koribacteraceae</td>
<td align="left">Candidatus Koribacter</td>
<td align="left">f__Candidatus Koribacter_217472</td>
</tr>
<tr class="even">
<td>623634</td>
<td align="left">Bacteria</td>
<td align="left">Acidobacteria</td>
<td align="left">Solibacteres</td>
<td align="left">Solibacterales</td>
<td align="left">Solibacteraceae</td>
<td align="left">Candidatus Solibacter</td>
<td align="left">f__Candidatus Solibacter_623634</td>
</tr>
</tbody>
</table>
<p>Now the available taxonomy is added.<br>
There is a second version which will change the names in both otu table and taxonomy table. This can be useful if the analysis has to be done at OTU level. Only ID are less useful.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
ps0.f2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/format_to_besthit.html">format_to_besthit</a></span>(ps0)

<span class="kw">kable</span>(<span class="kw">head</span>(<span class="kw">tax_table</span>(ps0.f2)))</code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="left">Domain</th>
<th align="left">Phylum</th>
<th align="left">Class</th>
<th align="left">Order</th>
<th align="left">Family</th>
<th align="left">Genus</th>
<th align="left">Species</th>
<th align="left">best_hit</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>OTU-541135:Lactobacillus</td>
<td align="left">Bacteria</td>
<td align="left">Firmicutes</td>
<td align="left">Bacilli</td>
<td align="left">Lactobacillales</td>
<td align="left">Lactobacillaceae</td>
<td align="left">Lactobacillus</td>
<td align="left">g__Lactobacillus</td>
<td align="left">OTU-541135:Lactobacillus</td>
</tr>
<tr class="even">
<td>OTU-1050608:Corynebacterium</td>
<td align="left">Bacteria</td>
<td align="left">Actinobacteria</td>
<td align="left">Actinobacteria</td>
<td align="left">Actinomycetales</td>
<td align="left">Corynebacteriaceae</td>
<td align="left">Corynebacterium</td>
<td align="left">g__Corynebacterium</td>
<td align="left">OTU-1050608:Corynebacterium</td>
</tr>
<tr class="odd">
<td>OTU-370251:f__Endozoicimonaceae</td>
<td align="left">Bacteria</td>
<td align="left">Proteobacteria</td>
<td align="left">Gammaproteobacteria</td>
<td align="left">Oceanospirillales</td>
<td align="left">Endozoicimonaceae</td>
<td align="left">f__Endozoicimonaceae</td>
<td align="left">f__Endozoicimonaceae</td>
<td align="left">OTU-370251:f__Endozoicimonaceae</td>
</tr>
<tr class="even">
<td>OTU-188753:Blautia</td>
<td align="left">Bacteria</td>
<td align="left">Firmicutes</td>
<td align="left">Clostridia</td>
<td align="left">Clostridiales</td>
<td align="left">Lachnospiraceae</td>
<td align="left">Blautia</td>
<td align="left">g__Blautia</td>
<td align="left">OTU-188753:Blautia</td>
</tr>
<tr class="odd">
<td>OTU-217472:Candidatus Koribacter</td>
<td align="left">Bacteria</td>
<td align="left">Acidobacteria</td>
<td align="left">Acidobacteriia</td>
<td align="left">Acidobacteriales</td>
<td align="left">Koribacteraceae</td>
<td align="left">Candidatus Koribacter</td>
<td align="left">g__Candidatus Koribacter</td>
<td align="left">OTU-217472:Candidatus Koribacter</td>
</tr>
<tr class="even">
<td>OTU-623634:Candidatus Solibacter</td>
<td align="left">Bacteria</td>
<td align="left">Acidobacteria</td>
<td align="left">Solibacteres</td>
<td align="left">Solibacterales</td>
<td align="left">Solibacteraceae</td>
<td align="left">Candidatus Solibacter</td>
<td align="left">g__Candidatus Solibacter</td>
<td align="left">OTU-623634:Candidatus Solibacter</td>
</tr>
</tbody>
</table>
<p>As can be seen, the rownames have the OTUIDs and available toxonomic name(s).</p>
</div>
<div id="summarize-the-percent-taxa-classification-for-phyloseq" class="section level2">
<h2 class="hasAnchor">
<a href="#summarize-the-percent-taxa-classification-for-phyloseq" class="anchor"></a>Summarize the percent taxa classification for phyloseq</h2>
<p>This can be useful to get an overview of taxonomic classifications. Only patterns such as [g__] or <code>NA</code> is expected. [g__<empty>] or similar are not considered. Pease convert for eg. g__unclassified to uniform [g__] or simply <code>NA</code>.</empty></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw"><a href="../reference/percent_classified.html">percent_classified</a></span>(ps0)
<span class="co">#&gt; Only patterns such as [g__] or similar is expected. [g__&lt;empty&gt;] or [g__unclassified] not considered</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;           please convert for eg. g__unclassified to uniform [g__] or NAs</span>
<span class="co">#&gt;   Taxonomic_Levels Percent_Classification</span>
<span class="co">#&gt; 1           Domain              99.9948 %</span>
<span class="co">#&gt; 2           Phylum              99.9895 %</span>
<span class="co">#&gt; 3            Class              99.8059 %</span>
<span class="co">#&gt; 4            Order              98.4682 %</span>
<span class="co">#&gt; 5           Family              87.3367 %</span>
<span class="co">#&gt; 6            Genus              55.6838 %</span>
<span class="co">#&gt; 7          Species              17.9772 %</span>
<span class="co">#&gt; 8        OTUs/ASVs                  19063</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
tax_sum &lt;-<span class="st"> </span><span class="kw"><a href="../reference/taxa_summary.html">taxa_summary</a></span>(ps0, <span class="st">"Phylum"</span>)
<span class="co">#&gt; Data provided is not compositional </span>
<span class="co">#&gt;  will first transform</span>
<span class="kw">kable</span>(tax_sum)</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Taxa</th>
<th align="left">Max.Rel.Ab</th>
<th align="left">Mean.Rel.Ab</th>
<th align="left">Median.Rel.Ab</th>
<th align="left">Std.dev</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">p__Firmicutes</td>
<td align="left">0.788082497512705</td>
<td align="left">0.459848226649128</td>
<td align="left">0.441254468879226</td>
<td align="left">0.14842871450415</td>
</tr>
<tr class="even">
<td align="left">p__Actinobacteria</td>
<td align="left">0.746566841628112</td>
<td align="left">0.172314456701022</td>
<td align="left">0.0696300860856344</td>
<td align="left">0.224441692879574</td>
</tr>
<tr class="odd">
<td align="left">p__Proteobacteria</td>
<td align="left">0.496513917951784</td>
<td align="left">0.158378330171694</td>
<td align="left">0.132796009653088</td>
<td align="left">0.144597900313421</td>
</tr>
<tr class="even">
<td align="left">p__Acidobacteria</td>
<td align="left">0.000347205328827773</td>
<td align="left">7.90462174369465e-05</td>
<td align="left">1.31309105778369e-05</td>
<td align="left">0.000119545094947851</td>
</tr>
<tr class="odd">
<td align="left">p__Crenarchaeota</td>
<td align="left">0.00017677415675876</td>
<td align="left">3.6066057468981e-05</td>
<td align="left">1.02123554134977e-05</td>
<td align="left">5.1552434270983e-05</td>
</tr>
<tr class="even">
<td align="left">p__Chloroflexi</td>
<td align="left">0.000410572235052605</td>
<td align="left">9.97047375159692e-05</td>
<td align="left">1.81774435053788e-05</td>
<td align="left">0.00014087267611533</td>
</tr>
<tr class="odd">
<td align="left">p__Bacteroidetes</td>
<td align="left">0.176311167064961</td>
<td align="left">0.0867332448761004</td>
<td align="left">0.0948124481889113</td>
<td align="left">0.056716832998034</td>
</tr>
<tr class="even">
<td align="left">p__Planctomycetes</td>
<td align="left">0.000232773979450236</td>
<td align="left">7.54811429815197e-05</td>
<td align="left">7.4215748345353e-06</td>
<td align="left">9.43520018502368e-05</td>
</tr>
<tr class="odd">
<td align="left">p__Cyanobacteria</td>
<td align="left">0.0289266439035136</td>
<td align="left">0.00480453245392559</td>
<td align="left">0.00176009539745434</td>
<td align="left">0.00785714639094799</td>
</tr>
<tr class="even">
<td align="left">p__Tenericutes</td>
<td align="left">0.0269522006625651</td>
<td align="left">0.00241319964620587</td>
<td align="left">0.000181905749276683</td>
<td align="left">0.00712234796497308</td>
</tr>
<tr class="odd">
<td align="left">p__Verrucomicrobia</td>
<td align="left">0.480223292851242</td>
<td align="left">0.107050184932518</td>
<td align="left">0.0233774668438226</td>
<td align="left">0.145628946750621</td>
</tr>
<tr class="even">
<td align="left">p__[Thermi]</td>
<td align="left">0.00130584780315342</td>
<td align="left">0.000270077302318603</td>
<td align="left">2.64061100097892e-05</td>
<td align="left">0.000450648385553297</td>
</tr>
<tr class="odd">
<td align="left">p__AD3</td>
<td align="left">3.07848600058491e-05</td>
<td align="left">3.27587462019308e-06</td>
<td align="left">0</td>
<td align="left">8.87865275163025e-06</td>
</tr>
<tr class="even">
<td align="left">p__Fusobacteria</td>
<td align="left">0.00329946357108393</td>
<td align="left">0.000567048234851298</td>
<td align="left">4.04491765065732e-05</td>
<td align="left">0.000979884289358478</td>
</tr>
<tr class="odd">
<td align="left">p__TM7</td>
<td align="left">0.0362903008954261</td>
<td align="left">0.00593363497042541</td>
<td align="left">0.000492898877000854</td>
<td align="left">0.0108335813609163</td>
</tr>
<tr class="even">
<td align="left">p__Spirochaetes</td>
<td align="left">0.00735672063736829</td>
<td align="left">0.000568048382949663</td>
<td align="left">1.29765860497247e-05</td>
<td align="left">0.00195507905338325</td>
</tr>
<tr class="odd">
<td align="left">p__Gemmatimonadetes</td>
<td align="left">0.000105541692737978</td>
<td align="left">1.82934674152798e-05</td>
<td align="left">2.36630383341221e-06</td>
<td align="left">3.23718991323651e-05</td>
</tr>
<tr class="even">
<td align="left">p__BRC1</td>
<td align="left">2.21149890973104e-06</td>
<td align="left">1.57964207837931e-07</td>
<td align="left">0</td>
<td align="left">5.9104794510269e-07</td>
</tr>
<tr class="odd">
<td align="left">p__WPS-2</td>
<td align="left">4.42299781946207e-05</td>
<td align="left">3.5856101264477e-06</td>
<td align="left">0</td>
<td align="left">1.18058731229867e-05</td>
</tr>
<tr class="even">
<td align="left">p__Nitrospirae</td>
<td align="left">0.000107747010020472</td>
<td align="left">1.82357194282387e-05</td>
<td align="left">2.2946726878878e-06</td>
<td align="left">3.14252021604013e-05</td>
</tr>
<tr class="odd">
<td align="left">p__Lentisphaerae</td>
<td align="left">0.000137276962239883</td>
<td align="left">2.40783509888569e-05</td>
<td align="left">5.37793433542176e-06</td>
<td align="left">3.92945542481875e-05</td>
</tr>
<tr class="even">
<td align="left">p__Euryarchaeota</td>
<td align="left">0.00198049266037629</td>
<td align="left">0.000228187024528476</td>
<td align="left">6.92807269399283e-06</td>
<td align="left">0.000536031110849026</td>
</tr>
<tr class="odd">
<td align="left">p__Synergistetes</td>
<td align="left">0.00141727415962427</td>
<td align="left">0.000452834039527414</td>
<td align="left">0.000109527814550652</td>
<td align="left">0.000568060718282255</td>
</tr>
<tr class="even">
<td align="left">p__Elusimicrobia</td>
<td align="left">0.000120619077414832</td>
<td align="left">3.63937421406076e-05</td>
<td align="left">2.47641521537313e-05</td>
<td align="left">4.17579793616951e-05</td>
</tr>
<tr class="odd">
<td align="left">p__Armatimonadetes</td>
<td align="left">5.7023921535084e-06</td>
<td align="left">4.073137252506e-07</td>
<td align="left">0</td>
<td align="left">1.52402840881832e-06</td>
</tr>
<tr class="even">
<td align="left">p__SR1</td>
<td align="left">0.000112936621043857</td>
<td align="left">8.54079412664644e-06</td>
<td align="left">0</td>
<td align="left">3.00991497698227e-05</td>
</tr>
<tr class="odd">
<td align="left">p__Deferribacteres</td>
<td align="left">5.67013539686471e-05</td>
<td align="left">1.14771532017948e-05</td>
<td align="left">2.68896716771088e-06</td>
<td align="left">1.89757298451056e-05</td>
</tr>
<tr class="even">
<td align="left">p__TM6</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">p__SBR1093</td>
<td align="left">2.43264880070414e-05</td>
<td align="left">3.24126252070945e-06</td>
<td align="left">0</td>
<td align="left">7.61025506689207e-06</td>
</tr>
<tr class="even">
<td align="left">p__Chlorobi</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">p__FBP</td>
<td align="left">8.84599563892415e-06</td>
<td align="left">6.31856831351725e-07</td>
<td align="left">0</td>
<td align="left">2.36419178041076e-06</td>
</tr>
<tr class="even">
<td align="left">p__Thermotogae</td>
<td align="left">5.13081000097485e-05</td>
<td align="left">3.66486428641061e-06</td>
<td align="left">0</td>
<td align="left">1.37126665287723e-05</td>
</tr>
<tr class="odd">
<td align="left">p__NKB19</td>
<td align="left">6.03095387074158e-05</td>
<td align="left">4.30782419338684e-06</td>
<td align="left">0</td>
<td align="left">1.61184022141094e-05</td>
</tr>
<tr class="even">
<td align="left">p__OD1</td>
<td align="left">2.65379869167725e-05</td>
<td align="left">3.11751166980697e-06</td>
<td align="left">0</td>
<td align="left">8.1375479669482e-06</td>
</tr>
<tr class="odd">
<td align="left">p__WS3</td>
<td align="left">4.56191372280672e-05</td>
<td align="left">5.94726277664907e-06</td>
<td align="left">0</td>
<td align="left">1.32918409508262e-05</td>
</tr>
<tr class="even">
<td align="left">p__OP11</td>
<td align="left">7.09562058297619e-06</td>
<td align="left">5.06830041641156e-07</td>
<td align="left">0</td>
<td align="left">1.89638436914558e-06</td>
</tr>
<tr class="odd">
<td align="left">p__GAL15</td>
<td align="left">3.54781029148809e-06</td>
<td align="left">2.53415020820578e-07</td>
<td align="left">0</td>
<td align="left">9.48192184572788e-07</td>
</tr>
<tr class="even">
<td align="left">p__GN02</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">p__FCPU426</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">p__</td>
<td align="left">2.21149890973104e-06</td>
<td align="left">1.57964207837931e-07</td>
<td align="left">0</td>
<td align="left">5.9104794510269e-07</td>
</tr>
<tr class="odd">
<td align="left">p__OP1</td>
<td align="left">1.99034901875793e-05</td>
<td align="left">1.42167787054138e-06</td>
<td align="left">0</td>
<td align="left">5.31943150592421e-06</td>
</tr>
<tr class="even">
<td align="left">p__SAR406</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">p__NC10</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">p__KSB3</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">p__TPD-58</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
</tbody>
</table>
</div>
<div id="distribution-of-reads" class="section level2">
<h2 class="hasAnchor">
<a href="#distribution-of-reads" class="anchor"></a>Distribution of reads</h2>
<p>Useful for QC purposes. Check for siatribution of sequencing depth.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_read_distribution.html">plot_read_distribution</a></span>(ps0, <span class="dt">groups=</span><span class="st">"SampleType"</span>, <span class="dt">plot.type=</span> <span class="st">"density"</span>)
<span class="co">#&gt; [1] "Done plotting"</span>
<span class="kw">print</span>(p)</code></pre></div>
<p><img src="microbiomeutilities_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div id="convert-phyloseq-object-to-long-data-format" class="section level2">
<h2 class="hasAnchor">
<a href="#convert-phyloseq-object-to-long-data-format" class="anchor"></a>Convert phyloseq object to long data format</h2>
<p>Useful if the user wants to plot specific features.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
pseq_df &lt;-<span class="st"> </span><span class="kw"><a href="../reference/phy_to_ldf.html">phy_to_ldf</a></span>(ps0, <span class="dt">transform.counts =</span> <span class="ot">NULL</span>)
<span class="co">#&gt; An additonal column Sam_rep with sample names is created for reference purpose</span>

<span class="kw">kable</span>(<span class="kw">head</span>(pseq_df))</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">OTUID</th>
<th align="left">Domain</th>
<th align="left">Phylum</th>
<th align="left">Class</th>
<th align="left">Order</th>
<th align="left">Family</th>
<th align="left">Genus</th>
<th align="left">Species</th>
<th align="left">Sam_rep</th>
<th align="right">Abundance</th>
<th align="left">SampleID</th>
<th align="left">Subject</th>
<th align="left">Age</th>
<th align="left">InputFileName</th>
<th align="right">Sex</th>
<th align="left">SampleType</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">541135</td>
<td align="left">k__Bacteria</td>
<td align="left">p__Firmicutes</td>
<td align="left">c__Bacilli</td>
<td align="left">o__Lactobacillales</td>
<td align="left">f__Lactobacillaceae</td>
<td align="left">g__Lactobacillus</td>
<td align="left">s__</td>
<td align="left">cb110</td>
<td align="right">0</td>
<td align="left">cb110</td>
<td align="left">Subject_110</td>
<td align="left">C</td>
<td align="left">cb110.fasta</td>
<td align="right">1</td>
<td align="left">Biopsy</td>
</tr>
<tr class="even">
<td align="left">1050608</td>
<td align="left">k__Bacteria</td>
<td align="left">p__Actinobacteria</td>
<td align="left">c__Actinobacteria</td>
<td align="left">o__Actinomycetales</td>
<td align="left">f__Corynebacteriaceae</td>
<td align="left">g__Corynebacterium</td>
<td align="left">s__</td>
<td align="left">cb110</td>
<td align="right">5</td>
<td align="left">cb110</td>
<td align="left">Subject_110</td>
<td align="left">C</td>
<td align="left">cb110.fasta</td>
<td align="right">1</td>
<td align="left">Biopsy</td>
</tr>
<tr class="odd">
<td align="left">370251</td>
<td align="left">k__Bacteria</td>
<td align="left">p__Proteobacteria</td>
<td align="left">c__Gammaproteobacteria</td>
<td align="left">o__Oceanospirillales</td>
<td align="left">f__Endozoicimonaceae</td>
<td align="left">g__</td>
<td align="left">s__</td>
<td align="left">cb110</td>
<td align="right">29</td>
<td align="left">cb110</td>
<td align="left">Subject_110</td>
<td align="left">C</td>
<td align="left">cb110.fasta</td>
<td align="right">1</td>
<td align="left">Biopsy</td>
</tr>
<tr class="even">
<td align="left">188753</td>
<td align="left">k__Bacteria</td>
<td align="left">p__Firmicutes</td>
<td align="left">c__Clostridia</td>
<td align="left">o__Clostridiales</td>
<td align="left">f__Lachnospiraceae</td>
<td align="left">g__Blautia</td>
<td align="left">s__</td>
<td align="left">cb110</td>
<td align="right">1</td>
<td align="left">cb110</td>
<td align="left">Subject_110</td>
<td align="left">C</td>
<td align="left">cb110.fasta</td>
<td align="right">1</td>
<td align="left">Biopsy</td>
</tr>
<tr class="odd">
<td align="left">217472</td>
<td align="left">k__Bacteria</td>
<td align="left">p__Acidobacteria</td>
<td align="left">c__Acidobacteriia</td>
<td align="left">o__Acidobacteriales</td>
<td align="left">f__Koribacteraceae</td>
<td align="left">g__Candidatus Koribacter</td>
<td align="left">s__</td>
<td align="left">cb110</td>
<td align="right">0</td>
<td align="left">cb110</td>
<td align="left">Subject_110</td>
<td align="left">C</td>
<td align="left">cb110.fasta</td>
<td align="right">1</td>
<td align="left">Biopsy</td>
</tr>
<tr class="even">
<td align="left">623634</td>
<td align="left">k__Bacteria</td>
<td align="left">p__Acidobacteria</td>
<td align="left">c__Solibacteres</td>
<td align="left">o__Solibacterales</td>
<td align="left">f__Solibacteraceae</td>
<td align="left">g__Candidatus Solibacter</td>
<td align="left">s__</td>
<td align="left">cb110</td>
<td align="right">0</td>
<td align="left">cb110</td>
<td align="left">Subject_110</td>
<td align="left">C</td>
<td align="left">cb110.fasta</td>
<td align="right">1</td>
<td align="left">Biopsy</td>
</tr>
</tbody>
</table>
</div>
<div id="plot-alpha-diversities" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-alpha-diversities" class="anchor"></a>Plot alpha diversities</h2>
<p>Utility plot function for diversity measures calcualted by <code>microbiome</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">library</span>(microbiome)
<span class="kw">data</span>(<span class="st">"biogeogut"</span>)
ps0 &lt;-<span class="st"> </span>biogeogut

p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_alpha_diversities.html">plot_alpha_diversities</a></span>(ps0, 
                            <span class="dt">type =</span> <span class="st">"diversities"</span>, 
                            <span class="dt">index.val =</span> <span class="st">"all"</span>, 
                            <span class="dt">plot.type =</span> <span class="st">"stripchart"</span>, 
                            <span class="dt">variableA =</span> <span class="st">"SampleType"</span>, 
                            <span class="dt">palette =</span> <span class="st">"jco"</span>)
<span class="co">#&gt; Using sam_rep_nw as id variables</span>
<span class="co">#&gt; Using SampleID, Subject, Age, InputFileName, SampleType, sam_rep_nw as id variables</span>

<span class="kw">print</span>(p)</code></pre></div>
<p><img src="microbiomeutilities_files/figure-html/unnamed-chunk-12-1.png" width="768"></p>
</div>
<div id="plot-ordination-and-core" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-ordination-and-core" class="anchor"></a>Plot ordination and core</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">library</span>(microbiomeutilities)
<span class="kw">library</span>(RColorBrewer)
<span class="kw">data</span>(<span class="st">"biogeogut"</span>)
p0 &lt;-<span class="st"> </span>biogeogut
ps1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/format_to_besthit.html">format_to_besthit</a></span>(p0)
 ps1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/format_to_besthit.html">format_to_besthit</a></span>(p0)
ps1 &lt;-<span class="st"> </span><span class="kw">subset_samples</span>(ps1, SampleType ==<span class="st"> "Stool"</span>)
 ps1 &lt;-<span class="st"> </span><span class="kw">prune_taxa</span>(<span class="kw">taxa_sums</span>(ps1) &gt;<span class="st"> </span><span class="dv">0</span>, ps1)
prev.thres &lt;-<span class="st"> </span><span class="kw">seq</span>(.<span class="dv">05</span>, <span class="dv">1</span>, .<span class="dv">05</span>)
det.thres &lt;-<span class="st"> </span><span class="dv">10</span>^<span class="kw">seq</span>(<span class="kw">log10</span>(<span class="fl">1e-4</span>), <span class="kw">log10</span>(.<span class="dv">2</span>), <span class="dt">length =</span> <span class="dv">10</span>)
pseq.rel &lt;-<span class="st"> </span>microbiome::<span class="kw">transform</span>(ps1, <span class="st">"compositional"</span>)
ord.bray &lt;-<span class="st"> </span><span class="kw">ordinate</span>(pseq.rel, <span class="st">"NMDS"</span>, <span class="st">"bray"</span>)
<span class="co">#&gt; Run 0 stress 0.03158633 </span>
<span class="co">#&gt; Run 1 stress 0.1499999 </span>
<span class="co">#&gt; Run 2 stress 0.1103514 </span>
<span class="co">#&gt; Run 3 stress 0.0315863 </span>
<span class="co">#&gt; ... New best solution</span>
<span class="co">#&gt; ... Procrustes: rmse 4.027427e-05  max resid 6.428555e-05 </span>
<span class="co">#&gt; ... Similar to previous best</span>
<span class="co">#&gt; Run 4 stress 0.07422367 </span>
<span class="co">#&gt; Run 5 stress 0.1482091 </span>
<span class="co">#&gt; Run 6 stress 0.03158629 </span>
<span class="co">#&gt; ... New best solution</span>
<span class="co">#&gt; ... Procrustes: rmse 1.8137e-05  max resid 2.497816e-05 </span>
<span class="co">#&gt; ... Similar to previous best</span>
<span class="co">#&gt; Run 7 stress 0.03158628 </span>
<span class="co">#&gt; ... New best solution</span>
<span class="co">#&gt; ... Procrustes: rmse 4.234627e-05  max resid 6.288592e-05 </span>
<span class="co">#&gt; ... Similar to previous best</span>
<span class="co">#&gt; Run 8 stress 0.07887621 </span>
<span class="co">#&gt; Run 9 stress 0.1482091 </span>
<span class="co">#&gt; Run 10 stress 0.07422367 </span>
<span class="co">#&gt; Run 11 stress 0.1482091 </span>
<span class="co">#&gt; Run 12 stress 0.07422368 </span>
<span class="co">#&gt; Run 13 stress 0.03158629 </span>
<span class="co">#&gt; ... Procrustes: rmse 3.528564e-05  max resid 5.786359e-05 </span>
<span class="co">#&gt; ... Similar to previous best</span>
<span class="co">#&gt; Run 14 stress 0.03158631 </span>
<span class="co">#&gt; ... Procrustes: rmse 3.504526e-05  max resid 5.595693e-05 </span>
<span class="co">#&gt; ... Similar to previous best</span>
<span class="co">#&gt; Run 15 stress 0.03158631 </span>
<span class="co">#&gt; ... Procrustes: rmse 8.167784e-05  max resid 0.0001225303 </span>
<span class="co">#&gt; ... Similar to previous best</span>
<span class="co">#&gt; Run 16 stress 0.1103514 </span>
<span class="co">#&gt; Run 17 stress 0.1482091 </span>
<span class="co">#&gt; Run 18 stress 0.1482091 </span>
<span class="co">#&gt; Run 19 stress 0.07887641 </span>
<span class="co">#&gt; Run 20 stress 0.07422367 </span>
<span class="co">#&gt; *** Solution reached</span>

p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_ordiplot_core.html">plot_ordiplot_core</a></span>(pseq.rel, ord.bray,
prev.thres, det.thres, <span class="dt">min.prevalence =</span> <span class="fl">0.9</span>,
 <span class="dt">color.opt =</span> <span class="st">"SampleType"</span>, <span class="dt">shape =</span> <span class="ot">NULL</span>, <span class="dt">Sample =</span> <span class="ot">TRUE</span>)
<span class="co">#&gt; Convergence reached in the ordination object provided</span>

<span class="kw">print</span>(p)</code></pre></div>
<p><img src="microbiomeutilities_files/figure-html/unnamed-chunk-13-1.png" width="1152"></p>
</div>
<div id="visualize-abundance-of-select-taxa" class="section level2">
<h2 class="hasAnchor">
<a href="#visualize-abundance-of-select-taxa" class="anchor"></a>Visualize abundance of select taxa</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
ps.f2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/format_to_besthit.html">format_to_besthit</a></span>(ps0)

psf2.rel &lt;-<span class="st"> </span>microbiome::<span class="kw">transform</span>(ps.f2, <span class="st">"compositional"</span>)
otu &lt;-<span class="st"> </span><span class="kw">abundances</span>(psf2.rel)
meta &lt;-<span class="st"> </span><span class="kw">meta</span>(psf2.rel)

<span class="kw">library</span>(vegan)
<span class="co">#&gt; Loading required package: permute</span>
<span class="co">#&gt; Loading required package: lattice</span>
<span class="co">#&gt; This is vegan 2.4-4</span>
permanova &lt;-<span class="st"> </span><span class="kw">adonis</span>(<span class="kw">t</span>(otu) ~<span class="st"> </span>SampleType,
               <span class="dt">data =</span> meta, <span class="dt">permutations=</span><span class="dv">99</span>, <span class="dt">method =</span> <span class="st">"bray"</span>)

<span class="co"># P-value</span>
<span class="kw">print</span>(<span class="kw">as.data.frame</span>(permanova$aov.tab)[<span class="st">"group"</span>, <span class="st">"Pr(&gt;F)"</span>])
<span class="co">#&gt; [1] NA</span>

coef &lt;-<span class="st"> </span><span class="kw">coefficients</span>(permanova)[<span class="st">"SampleType1"</span>,]
top.coef &lt;-<span class="st"> </span>coef[<span class="kw">rev</span>(<span class="kw">order</span>(<span class="kw">abs</span>(coef)))[<span class="dv">1</span>:<span class="dv">6</span>]]

top.coef.df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(top.coef)

my_taxa &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rownames</span>(top.coef.df))

p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_select_taxa.html">plot_select_taxa</a></span>(psf2.rel, my_taxa, <span class="st">"SampleType"</span>, <span class="st">"Paired"</span>, <span class="dt">plot.type =</span> <span class="st">"boxplot"</span>)
<span class="co">#&gt; An additonal column Sam_rep with sample names is created for reference purpose</span>
<span class="kw">print</span>(p)</code></pre></div>
<p><img src="microbiomeutilities_files/figure-html/unnamed-chunk-14-1.png" width="768"></p>
</div>
<div id="plot-taxa-boxplot" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-taxa-boxplot" class="anchor"></a>Plot taxa boxplot</h2>
<p>Plot relative abundance of top taxa specified by user.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
pn &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_taxa_boxplot.html">plot_taxa_boxplot</a></span>(ps0,
                        <span class="dt">taxonomic.level =</span> <span class="st">"Phylum"</span>,
                        <span class="dt">top.otu =</span> <span class="dv">5</span>, <span class="dt">VariableA =</span> <span class="st">"SampleType"</span>,
                        <span class="dt">title =</span> <span class="st">"Relative abudance plot"</span>, <span class="dt">color =</span> <span class="st">"Set2"</span>)
<span class="co">#&gt; The phy_tree slot is empty, easy to make the plot</span>

<span class="kw">print</span>(pn)</code></pre></div>
<p><img src="microbiomeutilities_files/figure-html/unnamed-chunk-15-1.png" width="576"></p>
</div>
<div id="plot-taxa-barplot" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-taxa-barplot" class="anchor"></a>Plot taxa barplot</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">library</span>(RColorBrewer)
<span class="kw">library</span>(dplyr)
<span class="co">#&gt; Warning: package 'dplyr' was built under R version 3.4.3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>

<span class="co"># reduce data for egample purposes</span>
ps.cor &lt;-<span class="st"> </span><span class="kw">core</span>(ps0, <span class="dt">detection =</span> <span class="dv">10</span>, <span class="dt">prevalence =</span> <span class="fl">0.5</span>)

p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_taxa_composition.html">plot_taxa_composition</a></span>(ps.cor, <span class="dt">taxonomic.level =</span> <span class="st">"Phylum"</span>, <span class="dt">transform =</span> <span class="st">"compositional"</span>, <span class="dt">average_by =</span> <span class="ot">NULL</span>)
<span class="kw">print</span>(p)</code></pre></div>
<p><img src="microbiomeutilities_files/figure-html/unnamed-chunk-16-1.png" width="576"></p>
</div>
<div id="heatmap-using-phyloseq-and-pheatmap" class="section level2">
<h2 class="hasAnchor">
<a href="#heatmap-using-phyloseq-and-pheatmap" class="anchor"></a>Heatmap using phyloseq and pheatmap</h2>
<p>Useful for visualisng differences in top otus between sample groups.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
heat.sample &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_taxa_heatmap.html">plot_taxa_heatmap</a></span>(ps0, <span class="dt">subset.top =</span> <span class="dv">20</span>,
    <span class="dt">VariableA =</span> <span class="st">"SampleType"</span>,
    <span class="dt">heatcolors =</span><span class="kw">brewer.pal</span>(<span class="dv">6</span>, <span class="st">"Blues"</span>),
    <span class="dt">transformation =</span> <span class="st">"compositional"</span>)
<span class="co">#&gt; Top 20 OTUs selected</span>
<span class="co">#&gt; First converted to compositional </span>
<span class="co">#&gt;  then top taxa were selected</span></code></pre></div>
<p><img src="microbiomeutilities_files/figure-html/unnamed-chunk-17-1.png" width="768"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">sessionInfo</span>()
<span class="co">#&gt; R version 3.4.1 (2017-06-30)</span>
<span class="co">#&gt; Platform: x86_64-w64-mingw32/x64 (64-bit)</span>
<span class="co">#&gt; Running under: Windows 7 x64 (build 7601) Service Pack 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Matrix products: default</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; locale:</span>
<span class="co">#&gt; [1] LC_COLLATE=Dutch_Netherlands.1252  LC_CTYPE=Dutch_Netherlands.1252   </span>
<span class="co">#&gt; [3] LC_MONETARY=Dutch_Netherlands.1252 LC_NUMERIC=C                      </span>
<span class="co">#&gt; [5] LC_TIME=Dutch_Netherlands.1252    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attached base packages:</span>
<span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; other attached packages:</span>
<span class="co">#&gt;  [1] dplyr_0.7.4                vegan_2.4-4               </span>
<span class="co">#&gt;  [3] lattice_0.20-35            permute_0.9-4             </span>
<span class="co">#&gt;  [5] RColorBrewer_1.1-2         bindrcpp_0.2.2            </span>
<span class="co">#&gt;  [7] tibble_1.4.2               knitr_1.20                </span>
<span class="co">#&gt;  [9] microbiomeutilities_0.99.0 microbiome_1.1.10012      </span>
<span class="co">#&gt; [11] ggplot2_2.2.1              phyloseq_1.23.1           </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; loaded via a namespace (and not attached):</span>
<span class="co">#&gt;  [1] viridis_0.5.1       Biobase_2.36.2      tidyr_0.8.0        </span>
<span class="co">#&gt;  [4] viridisLite_0.3.0   jsonlite_1.5        splines_3.4.1      </span>
<span class="co">#&gt;  [7] foreach_1.4.4       assertthat_0.2.0    highr_0.6          </span>
<span class="co">#&gt; [10] stats4_3.4.1        yaml_2.1.18         ggrepel_0.7.0      </span>
<span class="co">#&gt; [13] pillar_1.2.1        backports_1.1.2     glue_1.2.0         </span>
<span class="co">#&gt; [16] digest_0.6.15       XVector_0.16.0      colorspace_1.3-2   </span>
<span class="co">#&gt; [19] cowplot_0.9.2       htmltools_0.3.6     Matrix_1.2-14      </span>
<span class="co">#&gt; [22] plyr_1.8.4          pkgconfig_2.0.1     pheatmap_1.0.8     </span>
<span class="co">#&gt; [25] zlibbioc_1.22.0     purrr_0.2.4         scales_0.5.0       </span>
<span class="co">#&gt; [28] Rtsne_0.13          mgcv_1.8-23         IRanges_2.10.5     </span>
<span class="co">#&gt; [31] ggpubr_0.1.6        BiocGenerics_0.22.1 lazyeval_0.2.1     </span>
<span class="co">#&gt; [34] survival_2.41-3     magrittr_1.5        crayon_1.3.4       </span>
<span class="co">#&gt; [37] memoise_1.1.0       evaluate_0.10.1     fs_1.2.2           </span>
<span class="co">#&gt; [40] nlme_3.1-137        MASS_7.3-49         xml2_1.2.0         </span>
<span class="co">#&gt; [43] tools_3.4.1         data.table_1.10.4-3 stringr_1.3.0      </span>
<span class="co">#&gt; [46] S4Vectors_0.14.7    munsell_0.4.3       ggsci_2.8          </span>
<span class="co">#&gt; [49] cluster_2.0.7-1     Biostrings_2.44.2   ade4_1.7-11        </span>
<span class="co">#&gt; [52] compiler_3.4.1      pkgdown_0.1.0.9000  rlang_0.2.0.9001   </span>
<span class="co">#&gt; [55] rhdf5_2.20.0        grid_3.4.1          iterators_1.0.9    </span>
<span class="co">#&gt; [58] biomformat_1.4.0    rstudioapi_0.7      igraph_1.2.1       </span>
<span class="co">#&gt; [61] labeling_0.3        rmarkdown_1.9       gtable_0.2.0       </span>
<span class="co">#&gt; [64] codetools_0.2-15    multtest_2.32.0     roxygen2_6.0.1     </span>
<span class="co">#&gt; [67] reshape2_1.4.3      R6_2.2.2            gridExtra_2.3      </span>
<span class="co">#&gt; [70] bindr_0.1.1         commonmark_1.4      rprojroot_1.3-2    </span>
<span class="co">#&gt; [73] desc_1.1.1          ape_5.1             stringi_1.1.7      </span>
<span class="co">#&gt; [76] parallel_3.4.1      Rcpp_0.12.16        tidyselect_0.2.4</span></code></pre></div>
</div>
<div id="package-requirements" class="section level2">
<h2 class="hasAnchor">
<a href="#package-requirements" class="anchor"></a>Package requirements</h2>
<ul>
<li>Depends:</li>
<li><a href="https://www.r-project.org/">R (&gt;= 3.4.1)</a></li>
<li><a href="https://joey711.github.io/phyloseq/index.html">phyloseq</a></li>
<li><a href="http://ggplot2.org/">ggplot2</a></li>
<li><p><a href="https://bioconductor.org/packages/devel/bioc/html/microbiome.html">microbiome</a></p></li>
<li>Imports:</li>
<li><a href="https://cran.r-project.org/web/packages/plyr/index.html">plyr</a></li>
<li><a href="https://cran.rstudio.com/web/packages/reshape2/index.html">reshape2</a></li>
<li><a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/00Index.html">stats</a></li>
<li><a href="http://tidyr.tidyverse.org/">tidyr</a></li>
<li><a href="https://stat.ethz.ch/R-manual/R-devel/library/utils/html/00Index.html">utils</a></li>
<li><a href="https://cran.r-project.org/web/packages/data.table/index.html">data.table</a></li>
<li><a href="https://cran.r-project.org/web/packages/vegan/index.html">vegan</a></li>
<li><a href="https://cran.r-project.org/web/packages/ggpubr/index.html">ggpubr</a></li>
<li><a href="https://cran.r-project.org/web/packages/RColorBrewer/index.html">RColorBrewer</a></li>
<li><a href="https://cran.r-project.org/web/packages/viridis/index.html">viridis</a></li>
<li><a href="https://cran.r-project.org/web/packages/pheatmap/index.html">pheatmap</a></li>
<li><p><a href="https://cran.r-project.org/web/packages/ggrepel/index.html">ggrepel</a></p></li>
<li>Suggests:</li>
<li><a href="https://bioconductor.org/packages/release/bioc/html/BiocGenerics.html">BiocGenerics</a></li>
<li><a href="https://cran.r-project.org/web/packages/knitr/index.html">knitr</a></li>
<li><a href="http://rmarkdown.rstudio.com/">rmarkdown</a></li>
<li><a href="https://cran.r-project.org/web/packages/ape/index.html">ape</a></li>
<li><p><a href="https://academic.oup.com/bioinformatics/article/26/11/1463/203321">Picante</a></p></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#install">Install</a></li>
      <li><a href="#example-data">Example data</a></li>
      <li><a href="#microbiome-analysis-pipeline">Microbiome analysis pipeline</a></li>
      <li><a href="#formatting-the-phyloseq-object">Formatting the Phyloseq Object</a></li>
      <li><a href="#summarize-the-percent-taxa-classification-for-phyloseq">Summarize the percent taxa classification for phyloseq</a></li>
      <li><a href="#distribution-of-reads">Distribution of reads</a></li>
      <li><a href="#convert-phyloseq-object-to-long-data-format">Convert phyloseq object to long data format</a></li>
      <li><a href="#plot-alpha-diversities">Plot alpha diversities</a></li>
      <li><a href="#plot-ordination-and-core">Plot ordination and core</a></li>
      <li><a href="#visualize-abundance-of-select-taxa">Visualize abundance of select taxa</a></li>
      <li><a href="#plot-taxa-boxplot">Plot taxa boxplot</a></li>
      <li><a href="#plot-taxa-barplot">Plot taxa barplot</a></li>
      <li><a href="#heatmap-using-phyloseq-and-pheatmap">Heatmap using phyloseq and pheatmap</a></li>
      <li><a href="#package-requirements">Package requirements</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Sudarshan Shetty, Leo Lahti.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
